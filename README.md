# โ๏ธ ArmyClash

## ๐ฎ ะ ะฟัะพะตะบัะต

ArmyClash โ ะฑะพะตะฒะฐั ัะธััะตะผะฐ ะดะปั RTS-ะฟะพะดะพะฑะฝะพะน ะธะณัั. ะะฒะต ะฐัะผะธะธ ัะฟะฐะฒะฝัััั ะฝะฐ ะฐัะตะฝะต ะธ ััะฐะถะฐัััั ะฒ ัะตะถะธะผะต ะฐะฒัะพะผะฐัะธัะตัะบะพะน ัะธะผัะปััะธะธ. ะัะพะตะบั ะดะตะผะพะฝัััะธััะตั ัะปะพะถะฝัั ะฐััะธัะตะบัััั ะฝะฐ ะฑะฐะทะต ะบะพะผะฟะพะฝะตะฝัะพะฒ, State Machine ะธ event-driven ะฒะทะฐะธะผะพะดะตะนััะฒะธั.

ะกััั ะฟัะพะตะบัะฐ ะฟะพะบะฐะทะฐัั, ััะพ ะผะพะถะฝะพ ัะดะตะปะฐัั ะฝะต ะฟัะพััะพ ะณะธะฑะบัั ะฐััะธัะตะบัััั ะดะปั ะพะดะฝะพะน ะธะณัั, ะฐ ะฟะตัะตะธัะฟะพะปัะทะพะฒะฐัั ะพะดะฝะพ ะธ ัะพ ะถะต ัะตัะตะฝะธะต ะดะปั ัะฐะทะฝัั ะฟัะพะตะบัะพะฒ. ะะพััะพะผั ะฑะฐะทะพะฒัะต ะฟัะธะฝัะธะฟั (State machine, ECS - ะฟะพะดะพะฑะฝะพะต ะฟะพะฒะตะดะตะฝะธะต) ั ะฒะทัะป ะธะท ะดััะณะพะณะพ ัะฒะพะตะณะพ ะฟัะพะตะบัะฐ: https://github.com/DinoCarbone/Gladiator.

## ๐ ะััะธัะตะบัััะฐ

### ะะฐัะฐะดะธะณะผะฐ: Component-Based + State Machine + Service-Oriented

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ        Component-Based Architecture     โ
โ  ะฎะฝะธั = ะะพะผะฟะพะฝะตะฝัั (ะฟัะพะฒะฐะนะดะตัั)         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ โข HealthProvider                        โ
โ โข DamageService                         โ
โ โข AttackAnimator                        โ
โ โข MaterialSwitcher                      โ
โ โข etc...                                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ  ัะฟัะฐะฒะปัะตััั
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      State Machine (ะฟัะธะพัะธัะตัะฝะฐั)       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
           โ  ะพะฑัะฐัััั ัะตัะตะท
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ    Service-Oriented (Events)            โ
โ  DamageService โ Event โ HealthProvider โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ ะัััััะน ััะฐัั

### ะฃััะฐะฝะพะฒะบะฐ
1. Clone ัะตะฟะพะทะธัะพัะธะน
2. ะัะบัะพะนัะต ะฒ Unity 6000.2.9f1+
3. ะัะบัะพะนัะต ััะตะฝั `Assets/Scenes/Main.unity`

### ะะฐะฟััะบ ัะธะผัะปััะธะธ
1. ะ ััะตะฝะต ะฝะฐะนะดะธัะต GameObject ั `DemonstrationMenu`
2. ะัะฑะตัะธัะต Formation ะดะปั ะฐัะผะธะธ A ะธ B
3. ะะฐะถะผะธัะต "Start Battle"
4. ะะฐะฑะปัะดะฐะนัะต ะฑะพะตะฒัั ัะธะผัะปััะธั

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
Assets/Scripts/
โโโ Core/
โ   โโโ Behaviors/        # ะกะพััะพัะฝะธั, ะบะพะผะฟะพะฝะตะฝัั
โ   โโโ Simulation/       # ะะพะตะฒะฐั ัะธััะตะผะฐ
โ   โโโ Services/         # DI, State Machine
โ   โโโ Demonstration/    # ะขะตััะพะฒะพะต UI ะผะตะฝั
โโโ Data/
โ   โโโ Dto/              # Data Transfer Objects
โ   โโโ ScriptableObjects/# ะะพะฝัะธะณะธ
โโโ Utils/                # ะฃัะธะปะธัั
```

## ๐ฎ ะัะฝะพะฒะฝะฐั ะปะพะณะธะบะฐ

## ๐๏ธ ะะธะทะฝะตะฝะฝัะน ัะธะบะป

```
1. DI ะะฝัะตะบัะธั (Zenject)
   โ
2. SimulationFacade.Initialize() ัะฟะฐะฒะฝะธั ะพะฑะต ะฐัะผะธะธ ะฟะพ ะบะพะฝัะธะณะฐะผ ัะพัะผะฐัะธะธ ะธ ะดะฐะฝะฝัะผ ะธะท ะฟัะพะฒะฐะนะดะตัะฐ ัะธะผัะปััะธะธ
   โ
3. EntityFactory.Create() ัะพะทะดะฐะตั ัะฝะธัะพะฒ ะฟะพ ะฒัะทะพะฒั SimulationFacade
   โ
4. EntityBase.Construct() ะธะฝะธัะธะฐะปะธะทะธััะตั
   โโ InitializeStates()    - ัะพะทะดะฐะตั ัะพััะพัะฝะธั
   โโ InitializeProviders() - ัะพะทะดะฐะตั ะบะพะผะฟะพะฝะตะฝัั
   โโ InjectServices()      - ะธะฝะถะตะบัะธััะตั DI
   โ
5. BattleController.StartSimulating() ะฝะฐัะธะฝะฐะตั ะฑะพะน
   โ
6. ะะฐะถะดัะน ััะตะนะผ: Update() ัะธะบะป
   โโ BattleController.OnTick()    - ัะฐัะฟัะตะดะตะปัะตั ัะตะปะธ
   โโ EntityBase.Update()          - ะพะฑะฝะพะฒะปัะตั ัะพััะพัะฝะธั
   โ
7. ะกะผะตััั ัะฝะธัะฐ: ะฃะดะฐะปะตะฝะธะต ะธ ะฟะตัะตััะตั ัะตะปะตะน
   โ
8. ะะพัะปะต ัะพะณะพ, ะบะฐะบ 1 ะบะพะผะฐะฝะดะฐ ะฟะพัะตััะปะฐ ะฒัะตั ัะฝะธัะพะฒ - ะพะฝะฐ ััะธัะฐะตััั ะฟัะพะธะณัะฐะฒัะตะน
```

### ะะพะตะฒะพะน ัะธะบะป (ะบะฐะถะดัะน ััะตะนะผ)
```
1. BattleController.UpdateTargets()
   โโ ะะปั ะบะฐะถะดะพะณะพ ัะฝะธัะฐ ะฐัะผะธะธ A ะฒัะฑัะฐัั ะปััััั ัะตะปั ะธะท B
   โโ ะะปั ะบะฐะถะดะพะณะพ ัะฝะธัะฐ ะฐัะผะธะธ B ะฒัะฑัะฐัั ะปััััั ัะตะปั ะธะท A
   โโ ApplyTargets() - ัััะฐะฝะพะฒะธัั ะฒัะฑัะฐะฝะฝัะต ัะตะปะธ

2. EntityBase.Update() โ StateMachine.Update()
   โโ ProcessExits() - ะฒััะพะด ะธะท ัะตะบััะธั ัะพััะพัะฝะธะน
   โโ UpdateCurrentStates() - ะพะฑะฝะพะฒะปะตะฝะธะต ะฐะบัะธะฒะฝัั
   โโ ProcessNewStates() - ะฒัะพะด ะฒ ะฝะพะฒัะต ัะพััะพัะฝะธั
   โโ ApplyPendingChanges() - ะฟัะธะผะตะฝะตะฝะธะต ะพัะปะพะถะตะฝะฝัั ะธะทะผะตะฝะตะฝะธะน

3. ะะบัะธะฒะฝัะต ะบะพะผะฟะพะฝะตะฝัั ัะตะฐะณะธัััั:
   โโ DelayAttack.Update() โ Timer.Update()
   โโ MovementState.Update() โ ะดะฒะธะถะตะฝะธะต ะบ ัะตะปะธ
   โโ Providers.Update() โ ะพะฑัะฐะฑะพัะบะฐ ัะพะฑััะธะน
```

### ะัะฑะพั ัะตะปะธ (BattleController)
```
Score = Distance Score (70%) + Balance Score (30%)

Distance Score = 1 / distance * 0.7
Balance Score = (3 - ัะตะบััะธั_ะฐัะฐะบัััะธั) * 0.3

ะัะฑะธัะฐะตััั ัะตะปั ั ะผะฐะบัะธะผะฐะปัะฝัะผ Score
```

### ะกะธััะตะผะฐ ัะพััะพัะฝะธะน (State Machine)

ะะฐะถะดัะน ัะฝะธั ะผะพะถะตั ะฑััั ะฒ ะพะดะฝะพะผ ะธะปะธ ะฝะตัะบะพะปัะบะธั ัะพััะพัะฝะธัั ะพะดะฝะพะฒัะตะผะตะฝะฝะพ:

| ะกะพััะพัะฝะธะต | ะัะธะพัะธัะตั | ะะฟะธัะฐะฝะธะต |
|-----------|-----------|---------|
| DeadState | 100 | ะฎะฝะธั ะผะตััะฒ (ะฟะตัะตะบััะฒะฐะตั ะฒัะต) |
| AttackState | 50 | ะัะฐะบะฐ ะฒัะฐะณะฐ |
| MovementState | 10 | ะะฒะธะถะตะฝะธะต ะบ ัะตะปะธ |
| IdleState | 0 | ะะธัะตะณะพ ะฝะต ะดะตะปะฐะตั |

## ๐ง ะะพะผะฟะพะฝะตะฝัั (Providers)

ะะฐะถะดัะน ัะฝะธั ัะพะฑะธัะฐะตััั ะธะท ะบะพะผะฟะพะฝะตะฝัะพะฒ:

```csharp
// ะัะธะผะตัั:
- HealthProvider          // ะะดะพัะพะฒัะต
- DamageService          // ะฃัะพะฝ
- AttackAnimator         // ะะฝะธะผะฐัะธั
- EnemyAgent             // AI ะดะฒะธะถะตะฝะธั
- MaterialSwitcher       // ะะธะทัะฐะปะธะทะฐัะธั
- HealthDisplay          // UI
```

## ๐พ Event System

ะะพะผะฟะพะฝะตะฝัั ะพะฑัะฐัััั ัะตัะตะท ัะพะฑััะธั:

```csharp
// ะัะธะผะตั: ะฐัะฐะบะฐ ะฝะฐะฝะพัะธั ััะพะฝ
DamageService.EmitDamage()
  โโ EmitEvent(new DamageData(damage))
  โโ HealthProvider.ReceiveEvent() ะฟะพะปััะฐะตั ััะพะฝ
      โโ health -= damage
```

**ะขะธะฟั ัะพะฑััะธะน:**
- `DamageData` โ ััะพะฝ
- `DamageModifierData` โ ะธะทะผะตะฝะตะฝะธะต ััะพะฝะฐ
- `HealthModifierData` โ ะธะทะผะตะฝะตะฝะธะต ะทะดะพัะพะฒัั
- `AttackSpeedModifierData` โ ะธะทะผะตะฝะตะฝะธะต ัะบะพัะพััะธ ะฐัะฐะบะธ
- `SpeedModifierData` โ ะธะทะผะตะฝะตะฝะธะต ัะบะพัะพััะธ ะดะฒะธะถะตะฝะธั

## โ๏ธ ะกะธััะตะผะฐ ะบะพะฝัะธะณััะฐัะธะธ (ScriptableObjects)

### ะะพะฝัะธะณะธ ะตะดะธะฝะธั
- `ShapeConfig` โ ัะพัะผะฐ (ะบัะฑ, ััะตัะฐ)
- `SizeConfig` โ ัะฐะทะผะตั (S/B)
- `MaterialConfig` โ ะผะฐัะตัะธะฐะป/ัะฒะตั
- `IconConfig` โ ะธะบะพะฝะบะฐ ะดะปั ะพัะปะธัะตะฝะธั ะบะพะผะฐะฝะด

### ะะพะดะธัะธะบะฐัะพัั
- `HealthModifierConfig` โ ะฑะฐััั ะทะดะพัะพะฒัั
- `DamageModifierConfig` โ ะฑะฐััั ััะพะฝะฐ
- `AttackSpeedModifierConfig` โ ะฑะฐััั ัะบะพัะพััะธ ะฐัะฐะบะธ
- `SpeedModifierConfig` โ ะฑะฐััั ัะบะพัะพััะธ ะดะฒะธะถะตะฝะธั

### ๐ ะะพะฟะพะปะฝะธัะตะปัะฝะฐั ััะฝะบัะธั - ะคะพัะผะฐัะธะธ (ัััะฐะฝะพะฒะบะฐ ัััะพั ะฐัะผะธะธ)
- `TriangleFormation` โ ััะตัะณะพะปัะฝัะน ัััะพะน (ัะทะบะฐั ัะฟะตัะตะดะธ, ัะธัะพะบะฐั ัะทะฐะดะธ)
- `RectangleFormation` โ ะฟััะผะพัะณะพะปัะฝัะน ัััะพะน (ะฝะฐัััะฐะธะฒะฐะตััั ัะธัะธะฝะฐ ััะดะพะฒ)

**ะะฐะบ ัะฐะฑะพัะฐะตั:** ะคะฐัะฐะด ัะฟะฐะฒะฝะฐ ะฟะพะปััะฐะตั `FormationConfig`, ะฒัะทัะฒะฐะตั `GetFormationData(unitCount, centerPosition)` ะธ ะฟะพะปััะฐะตั ะฟะพะทะธัะธะธ ะดะปั ัะฝะธัะพะฒ. ะฎะฝะธัั ัะฟะฐะฒะฝัััั ะฟะพ ััะธะผ ะบะพะพัะดะธะฝะฐัะฐะผ.

**ะะฐะบ ัะพะทะดะฐัั ะฝะพะฒัั ัะพัะผะฐัะธั:**
1. ะกะพะทะดะฐะน ะบะปะฐัั ะฝะฐัะปะตะดัั `FormationConfig`:
```csharp
[CreateAssetMenu(fileName = "CircleFormation", menuName = "ScriptableObjects/Formation/Circle")]
public class CircleFormation : FormationConfig
{
    public override List<Vector3> GetFormationData(int countUnits, Vector3 center)
    {
        var positions = new List<Vector3>();
        float radius = Mathf.Sqrt(countUnits) * unitSpacing;
        for (int i = 0; i < countUnits; i++)
        {
            float angle = (i / (float)countUnits) * Mathf.PI * 2;
            positions.Add(center + new Vector3(Mathf.Cos(angle) * radius, 0, Mathf.Sin(angle) * radius));
        }
        return positions;
    }
}
```
2. ะกะพะทะดะฐะน SO: `Create โ ScriptableObjects โ Formation โ Circle`
3. ะัะฟะพะปัะทัะน ะฒ `DemonstrationMenu` ะธะปะธ ะฟัะธัะฒะพะน ะฒ `GlobalInstaller`

## โ๏ธ ะะฐะบ ะดะพะฑะฐะฒะธัั ะฝะพะฒะพะต ัะพััะพัะฝะธะต

### 1๏ธโฃ ะกะพะทะดะฐะน ะบะปะฐัั ัะพััะพัะฝะธั
ะะฐัะปะตะดัะน `IState`

### 2๏ธโฃ ะกะพะทะดะฐะน ScriptableObject ัะฐะฑัะธะบั
- ะะฐัะปะตะดัะน `BehaviorSO<YourState>`
- ะฃะบะฐะถะธ ะฝะตัะพะฒะผะตััะธะผัะต ัะพััะพัะฝะธั ะฒ incompatibleStates ะฟัะธ ะฝะตะพะฑัะพะดะธะผะพััะธ

### 3๏ธโฃ ะะพะฑะฐะฒั ะฒ Entity ะฟัะตัะฐะฑ
- ะัะบัะพะน `Assets/Prefabs/Entity.prefab`
- ะ `EntityBase` โ ะฟะพะปะต `Entity Datas` โ ะดะพะฑะฐะฒั ะฝะพะฒัะน ัะปะตะผะตะฝั
- ะัะธัะฒะพะน ัะพะทะดะฐะฝะฝัะน SO ะฒ ะฟะพะปะต `Behavior SO`
- ะะตัะตะพะฟัะตะดะตะปะธ GetContextRequirements, ะตัะปะธ ะฝัะถะฝั ะบะพะผะฟะพะฝะตะฝัะฝัะต ะทะฐะฒะธัะธะผะพััะธ ะธ ะฟัะพะบะธะฝั ะธั ะฒ ะธะฝัะฟะตะบัะพัะต

### 4๏ธโฃ (ะะฟัะธะพะฝะฐะปัะฝะพ) ะะพะฑะฐะฒั ะฟัะธะพัะธัะตั
ะัะปะธ ัะพััะพัะฝะธะต ะดะพะปะถะฝะพ ะฟะตัะตะบััะฒะฐัั ะดััะณะธะต, ะพััะตะดะฐะบัะธััะน `PriorityBehaviorsSO`:

**ะะพัะพะฒะพ!** ะกะพััะพัะฝะธะต ะฐะฒัะพะผะฐัะธัะตัะบะธ ะธะฝะธัะธะฐะปะธะทะธััะตััั ะธ ะฑัะดะตั ัะฐะฑะพัะฐัั ัะตัะตะท StateMachine. ๐

### ๐๏ธ EntityBase Custom Editor

ะ Inspector'ะต ะดะปั EntityBase ะตััั **ะบะฐััะพะผะฝัะน ัะตะดะฐะบัะพั**, ะบะพัะพััะน ะฐะฒัะพะผะฐัะธัะตัะบะธ:
- ะัะพะฑัะฐะถะฐะตั **Entity Data Parts** (ัะพััะพัะฝะธั) ะบัะฐัะธะฒัะผ ัะฟะธัะบะพะผ ั ะบะฝะพะฟะบะฐะผะธ ัะดะฐะปะตะฝะธั
- ะัะพะฑัะฐะถะฐะตั **Providers** (ะบะพะผะฟะพะฝะตะฝัั) ั ัะธะฟะธะทะฐัะธะตะน
- ะะพะบะฐะทัะฒะฐะตั **ััะตะฑัะตะผัะต ะทะฐะฒะธัะธะผะพััะธ** ะดะปั ะบะฐะถะดะพะณะพ ัะพััะพัะฝะธั/ะฟัะพะฒะฐะนะดะตัะฐ (ัะตัะตะท `GetContextRequirements()`)
- ะะฒัะพะผะฐัะธัะตัะบะธ ัะพะทะดะฐะตั ะฝัะถะฝะพะต ะบะพะปะธัะตััะฒะพ ะฟะพะปะตะน ะดะปั ะบะพะฝัะตะบััะฐ

## ๐ค ะะฐะบ ะดะพะฑะฐะฒะธัั ัะฒะพะน ะผะพะดะธัะธะบะฐัะพั

1. ะกะพะทะดะฐะนัะต Config:
```csharp
[CreateAssetMenu]
public class MyModifierConfig : BaseEventConfig { }
```

2. ะกะพะทะดะฐะนัะต Data:
```csharp
public class MyModifierData : IEvent
{
    public int Value { get; set; }
}
```

3. ะะฑัะฐะฑะพัะฐะนัะต ะฒ ะบะพะผะฟะพะฝะตะฝัะต, ะฝะฐัะปะตะดัััั ะพั IInternalEventReceiver:
```csharp
public void ReceiveEvent(IEvent @event)
{
    if (@event is MyModifierData data)
    {
        // ะะฑัะฐะฑะพัะบะฐ
    }
}
```

## ๐ ะะธัะตะฝะทะธั

MIT

---

## ๐ค ะะฑ ะฐะฒัะพัะต

**ะะฒัะพั:** [Dino Carbone](https://github.com/DinoCarbone)

ะัะพะตะบั ัะพะทะดะฐะฝ ะบะฐะบ ะดะตะผะพะฝัััะฐัะธั ัะพะฒัะตะผะตะฝะฝัั ะฐััะธัะตะบัััะฝัั ะฟะพะดัะพะดะพะฒ ะฒ gamedev:
- Component-Based Design
- State Machine Patterns
- Event-Driven Architecture
- Dependency Injection (Zenject)
- Data-Driven Development

---
**ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต:** 19 ัะฝะฒะฐัั 2026
